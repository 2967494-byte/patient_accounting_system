<!-- Appointment Modal -->
<div id="appointment-modal" class="modal hidden">
    <div class="modal-content">
        <h2 id="modal-title">Новая запись</h2>
        <form id="appointment-form">
            <input type="hidden" id="appt-id">

            <div class="form-group">
                <label>Центр</label>
                <select id="appt-center" required>
                    {% for center in centers %}
                    <option value="{{ center.id }}">{{ center.name }}</option>
                    {% endfor %}
                </select>
            </div>

            <div class="form-group">
                <label>Дата</label>
                <input type="date" id="appt-date" required>
            </div>

            <div class="form-group">
                <label>Время</label>
                <select id="appt-time" required>
                    <!-- Populated via JS -->
                </select>
            </div>

            <div class="form-group">
                <label>ФИО Пациента</label>
                <input type="text" id="patient-name" required>
            </div>
            <div class="form-group">
                <label>Телефон</label>
                <input type="tel" id="patient-phone" required placeholder="+7 (___) ___ - __ - __">
            </div>
            <div class="form-group">
                <label>Врач</label>
                <input type="text" id="doctor" placeholder="ФИО врача (необязательно)">
            </div>
            <div class="form-group">
                <label>Услуга</label>
                <input type="text" id="service" list="services-list" required placeholder="Выберите услугу">
                <datalist id="services-list">
                    {% for service in services %}
                    <option value="{{ service.name }}">
                        {% endfor %}
                </datalist>
            </div>

            <!-- Additional Fields (Contract, Discount, Payment, Comment, etc) - Added to match Journal needs -->
            <!-- Note: Dashboard modal was simpler. Journal needs MORE fields. 
                 We should probably extend this modal to have all fields or show/hide them.
                 The user asked to "open creation window with filled fields". 
                 The creation window generally has minimal fields. 
                 But for "Edit", we imply full editing.
                 I should check if the Dashboard modal had all fields. 
                 Looking at dashboard.html content I read earlier (Step 213), it missed Contract, Payment Method, Discount, Comment, Child check.
                 I MUST add these to the modal for full editing. -->

            <!-- Extra fields hidden/removed for Dashboard simplcity 
            <div class="form-group checkbox-group"
                style="display:flex; align-items:center; gap:0.5rem; margin-top:10px;">
                <input type="checkbox" id="is-child">
                <label for="is-child" style="margin-bottom:0;">Ребенок</label>
            </div>

            <div class="form-group">
                <label>Договор №</label>
                <input type="text" id="contract-number">
            </div>

            <div class="form-group">
                <label>Способ оплаты</label>
                <select id="payment-method">
                    <option value="">-- Выберите --</option>
                    {% for pm in payment_methods %}
                    <option value="{{ pm.id }}">{{ pm.name }}</option>
                    {% endfor %}
                </select>
            </div>

            <div class="form-group">
                <label>Сумма / Стоимость (авторасчет)</label>
                <input type="number" id="cost" step="0.01" readonly style="background:#f3f4f6;">
            </div>

            <div class="form-group">
                <label>Скидка</label>
                <input type="number" id="discount" step="0.01" value="0">
            </div>

            <div class="form-group">
                <label>Комментарий</label>
                <textarea id="comment" rows="2"></textarea>
            </div>
            -->

            <div class="form-item-info hidden" id="author-info"></div>

            <div style="margin-top: 1rem; color: #6b7280; font-size: 0.875rem;">
                Автор: <span style="font-weight: 500; color: #1f2937;">{{ current_user.username }}</span>
            </div>

            <div class="modal-actions">
                <button type="button" id="btn-delete" class="btn-delete hidden"
                    onclick="deleteAppointment()">Удалить</button>
                <div class="right-actions">
                    <button type="button" class="btn-cancel" onclick="closeModal()">Отмена</button>
                    <button type="submit" class="btn-save">Сохранить</button>
                </div>
            </div>
        </form>
    </div>
</div>

<style>
    .btn-delete {
        background-color: #ef4444;
        color: white;
        border: none;
        padding: 0.5rem 1rem;
        border-radius: 0.375rem;
        cursor: pointer;
        margin-right: auto;
    }

    .btn-delete:hover {
        background-color: #dc2626;
    }

    .modal-actions {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 1.5rem;
    }

    .right-actions {
        display: flex;
        gap: 1rem;
    }

    .hidden {
        display: none !important;
    }

    .form-group {
        margin-bottom: 1rem;
    }

    .form-group label {
        display: block;
        margin-bottom: 0.25rem;
        font-weight: 500;
        color: #374151;
    }

    .form-group input,
    .form-group select,
    .form-group textarea {
        width: 100%;
        padding: 0.5rem;
        border: 1px solid #d1d5db;
        border-radius: 0.375rem;
        box-sizing: border-box;
    }
</style>