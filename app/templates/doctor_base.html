<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Кабинет врача{% endblock %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <style>
        .doctor-nav-icon {
            color: #4b5563;
            text-decoration: none;
            margin-right: 1.5rem;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            transition: color 0.2s;
        }

        .doctor-nav-icon:hover,
        .doctor-nav-icon.active {
            color: #9333ea;
        }

        /* Ensure main content takes full width and right padding */
        .main-content {
            padding: 2rem;
            max-width: 1400px;
            margin: 0 auto;
            width: 100%;
            box-sizing: border-box;
        }

        .app-container {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            background-color: #f9fafb;
        }
    </style>
    {% block extra_css %}{% endblock %}
</head>

<body>
    <div class="app-container">
        <header class="top-bar">
            <div class="header-left" style="display:flex; align-items:center;">
                <!-- Logo -->
                <img src="{{ url_for('static', filename='uploads/orbital_logo.png') }}" alt="Logo" class="app-logo"
                    style="max-height: 40px; width: auto; margin-right: 2rem;">

                <!-- Contact Info -->
                <div
                    style="display: flex; flex-direction: column; align-items: flex-start; justify-content: center; margin-left: 0;">
                    <div class="contact-phone"
                        style="font-weight: 700; font-size: 1.1rem; background: linear-gradient(135deg, #2563eb, #9333ea); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent;">
                        +7 (843) 528−20−28
                    </div>
                    <a href="mailto:orbital.3d.lab@gmail.com"
                        style="font-size: 0.85rem; color: #6b7280; text-decoration: none; margin-top: 5px; transition: color 0.2s;">
                        orbital.3d.lab@gmail.com
                    </a>
                </div>
            </div>

            <div class="user-controls header-actions">
                <!-- Navigation Icons -->
                <!-- Dashboard -->
                <a href="{{ url_for('doctor.dashboard') }}"
                    class="doctor-nav-icon {% if request.endpoint == 'doctor.dashboard' %}active{% endif %}"
                    title="Личный кабинет">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                        <polyline points="9 22 9 12 15 12 15 22"></polyline>
                    </svg>
                </a>

                <!-- Patients -->
                <a href="{{ url_for('doctor.patients') }}"
                    class="doctor-nav-icon {% if request.endpoint == 'doctor.patients' %}active{% endif %}"
                    title="Пациенты">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                        <circle cx="9" cy="7" r="4"></circle>
                        <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                        <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                    </svg>
                </a>

                <!-- Orders -->
                <a href="{{ url_for('doctor.orders') }}"
                    class="doctor-nav-icon {% if request.endpoint == 'doctor.orders' %}active{% endif %}"
                    title="Заказы и исследования">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                        <line x1="16" y1="13" x2="8" y2="13"></line>
                        <line x1="16" y1="17" x2="8" y2="17"></line>
                        <polyline points="10 9 9 9 8 9"></polyline>
                    </svg>
                </a>

                <!-- Appointments -->
                <a href="{{ url_for('doctor.appointments') }}"
                    class="doctor-nav-icon {% if request.endpoint == 'doctor.appointments' %}active{% endif %}"
                    title="Запись пациентов">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                        <line x1="16" y1="2" x2="16" y2="6"></line>
                        <line x1="8" y1="2" x2="8" y2="6"></line>
                        <line x1="3" y1="10" x2="21" y2="10"></line>
                        <line x1="12" y1="16" x2="12" y2="16"></line>
                    </svg>
                </a>

                <!-- Profile -->
                <a href="{{ url_for('main.profile') }}" class="profile-link">{{ current_user.username }}</a>
                <a href="{{ url_for('auth.logout') }}" class="btn-icon" title="Выйти" style="color: #4b5563;">
                    <img src="{{ url_for('static', filename='uploads/logout_icon.svg') }}" alt="Выйти"
                        style="width: 20px; height: 20px;">
                </a>
            </div>
        </header>

        <!-- Main Content Wrapper removed to allow full-width calendar -->
        {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
        <div style="margin-bottom: 1.5rem; padding: 0 2rem;">
            {% for category, message in messages %}
            <div style="padding: 1rem; border-radius: 0.375rem; margin-bottom: 0.5rem; 
                    background: {{ '#d1fae5' if category == 'success' else '#fee2e2' }};
                    color: {{ '#065f46' if category == 'success' else '#991b1b' }};">
                {{ message }}
            </div>
            {% endfor %}
        </div>
        {% endif %}
        {% endwith %}

        {% block content %}{% endblock %}
    </div>

    {% block scripts %}{% endblock %}
</body>

</html>